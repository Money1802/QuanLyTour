@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@{
	var filter = ViewData["filter"] as TourDemo.Models.System.Filter;
}

@model PagedList.IPagedList<TourDemo.Models.ModelViews.TourView>

<div class="py-6 px-6 text-center">
    <h2 class="mb-0 fs-10">DANH SÁCH TOUR</h2>
</div>

<div class="card w-100">
	<div class="card-body p-4">
		<form class="row" id="form">
			@Html.HiddenFor(m=>filter.PageIndex)
			@Html.HiddenFor(m=>filter.PageSize)
			<div class="col-2">
				@Html.DropDownListFor(m =>filter.Category, new SelectList(ViewBag.LTs, "Maloaitour", "Tenloai"), "-- Chọn loại Tour --", new { @class= "form-control" })
			</div>
			<div class="col-2">
				@Html.DropDownListFor(m =>filter.Sort, new SelectList(ViewBag.Sorts, "Value", "Text"), "-- Chọn loại Tour --", new { @class= "form-control" })
			</div>
			<div class="col-2">
				@Html.TextBoxFor(m=>filter.MoneyStart, new { @class = "form-control", @type = "number" })
			</div>
			<div class="col-2">
				@Html.TextBoxFor(m=>filter.MoneyEnd, new { @class = "form-control", @type = "number" })
			</div>
			<div class="col-4">
				<div class="input-group">
					@Html.TextBoxFor(m=>filter.Keyword, new {@class = "form-control"})
					<button id="btnSearch" type="submit" class="btn btn-icon btn-primary">Tìm kiếm</button>
				</div>
			</div>
		</form>
	</div>
</div>

<div class="row">
    @foreach (var item in Model)
    {
        <div class="col-sm-6 col-xl-3">
            <div class="card overflow-hidden rounded-2">
                <div class="position-relative">
                    <a asp-area="" asp-controller="Home" asp-action="Detail" asp-route-id="@item.Matour"><img src="@item.Hinhanh" class="card-img-top rounded-0" height="200" alt="..."></a>
                    <a asp-area="" asp-controller="Home" asp-action="Cart" asp-route-id="@item.Matour" class="bg-primary rounded-circle p-2 text-white d-inline-flex position-absolute bottom-0 end-0 mb-n3 me-3" data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Add To Cart"><i class="ti ti-basket fs-4"></i></a>
                </div>
                <div class="card-body pt-3 p-4">
                    <h6 class="fw-semibold fs-4">@item.Tentour</h6>
                    <div class="d-flex align-items-center justify-content-between">
						<h6 class="fw-semibold fs-4 mb-0">
							@(string.Format("{0:C}", Math.Round(item.Giagiam)).Replace("$", "")) VNĐ <span class="ms-2 fw-normal text-muted fs-3">
								@if (item.Giatour != item.Giagiam)
								{
									<del>@(string.Format("{0:C}", Math.Round(item.Giatour)).Replace("$", "")) VNĐ</del>
								}
							</span>
						</h6>
                        <ul class="list-unstyled d-flex align-items-center mb-0">
                            <li><a class="me-1" href="javascript:void(0)"><i class="ti ti-star text-warning"></i></a></li>
                            <li><a class="me-1" href="javascript:void(0)"><i class="ti ti-star text-warning"></i></a></li>
                            <li><a class="me-1" href="javascript:void(0)"><i class="ti ti-star text-warning"></i></a></li>
                            <li><a class="me-1" href="javascript:void(0)"><i class="ti ti-star text-warning"></i></a></li>
                            <li><a class="" href="javascript:void(0)"><i class="ti ti-star text-warning"></i></a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    }
</div>

<div class="py-6 px-6">
	@if (Model.Count > 0)
	{
		<nav aria-label="...">
			<ul class="pagination">
				<li class="page-item @(Model.PageNumber == 1 ? "disabled" : "")">
					<a class="page-link" onclick="toPage(1)" style="cursor: pointer">Đầu</a>
				</li>
				<li class="page-item @(Model.PageNumber == 1 ? "disabled" : "")">
					<a class="page-link" onclick="toPage(@(Model.PageNumber - 1))" style="cursor: pointer">Lùi</a>
				</li>
				@if (Model.Count() > 0)
				{
					for (int i = 1; i <= Model.PageCount; i++)
					{
						<li class="page-item @(i == Model.PageNumber ? "active" : "")">
							<a class="page-link" onclick="toPage(@i)" style="cursor: pointer">@i</a>
						</li>
					}
				}
				<li class="page-item @(Model.PageNumber == Model.PageCount ? "disabled" : "")">
					<a class="page-link" onclick="toPage(@(Model.PageNumber + 1))" style="cursor: pointer">Tiếp</a>
				</li>
				<li class="page-item @(Model.PageNumber == Model.PageCount ? "disabled" : "")">
					<a class="page-link" onclick="toPage(@(Model.PageCount))" style="cursor: pointer">Cuối</a>
				</li>
			</ul>
		</nav>
	}
</div>

@section Scripts{
	<script>
		$(document).ready(function () {


		});
		function toPage(index) {
			$("#filter_PageIndex").val(index)
			console.log($("#filter_PageIndex").val())
			$("#form").submit()
		}
	</script>
}